<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=44a592819a30c1c97bf844e1b73a78ea"></script>
  <title>React App</title>
</head>
<style>
  .default {
    position: absolute;
    display: none;
  }

  .vids {
    position: absolute;
    display: none;
  }

  .mask {
    position: fixed;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.616);
    opacity: 0;
    transition: all 1s;
    z-index: 10;
  }

  .mask.on {
    opacity: 1;
  }
</style>

<body>
  <div class="mask on"></div>
  <div class="default"></div>
  <div class="vids"></div>

  <div id="root"></div>

  <script>
    const def = document.querySelector('.default')
    const defVids = document.querySelector('.vids')
    const mask = document.querySelector('.mask')

    const pics = [
      "/portpolio_react2/img/store2_Moment.jpg",
      "/portpolio_react2/img/brandMoment.jpg",
      "/portpolio_react2/img/product3_Moment.jpg",
      "/portpolio_react2/img/brand2_Moment.jpg",
      "/portpolio_react2/img/detail0.jpg",
      "/portpolio_react2/img/detail3.jpg",
      "/portpolio_react2/img/detail4.jpg",
      "/portpolio_react2/img/detail2.jpg",
      "/portpolio_react2/img/product3.jpg",
      "/portpolio_react2/img/detail1.jpg",
      "/portpolio_react2/img/chrome2.jpg",
      "/portpolio_react2/img/brand3.jpg",
      "/portpolio_react2/img/brand4.jpg",
      "/portpolio_react2/img/brand2.jpg",
      "/portpolio_react2/img/chrome_banner2.jpg",
      "/portpolio_react2/img/becca-tapert-RjmGzTg4_mw-unsplash.jpg",
      "/portpolio_react2/img/banner14.jpg",
      "/portpolio_react2/img/banner12.jpg",
      "/portpolio_react2/img/chrome.jpg",
      "/portpolio_react2/img/banner00.jpg",
      "/portpolio_react2/img/banner00.png",
      "/portpolio_react2/img/banner23.jpg",
      "/portpolio_react2/img/banner222.jpg"]

    const vids = [
      "/portpolio_react2/img/store2_Trim2.mp4",
      "/portpolio_react2/img/brand.mp4",
      "/portpolio_react2/img/product3.mp4",
      "/portpolio_react2/img/brand2.mp4"]

    createDom()

    Promise.race([loadVids(), loadPics()]).then((res) => {
      //alert(res)
      mask.classList.remove('on');
      setTimeout(() => {
        def.remove();
        defVids.remove();
        mask.remove();
      }, 1000)
    })

    function createDom() {
      console.log('s')
      pics.forEach(f => {
        const src = `<img src=${f}></img>`
        def.innerHTML += src;
      }
      )
      vids.forEach(v => {
        const src = `<video src=${v}></video>`
        defVids.innerHTML += src;
      }
      )
    }

    function loadPics() {
      return new Promise((res, rej) => {
        let count = 0;
        const imgs = def.querySelectorAll('img')
        console.log('s')
        imgs.forEach(p => {
          p.onload = () => {
            count++;
            if (count == pics.length) {
              console.log(count)
              return res(true)
            };
          }
        })
      }).catch(console.log('count'))
    };
    function loadVids() {
      return new Promise((res, rej) => {
        let count = 0;
        const vids = defVids.querySelectorAll('video')
        console.log('s')
        vids.forEach(v => {
          v.onloaddata = () => {
            count++;
            if (count == vids.length) return res(true);
          }
        })
      }).catch(console.log('no'))
    };
  </script>
</body>

</html>